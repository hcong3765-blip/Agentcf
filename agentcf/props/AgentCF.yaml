user_group_order: ~
embedding_size: 64
record_path: dataset/
checkpoint_dir: ./saved
train_neg_sample_args:
  distribution: popularity
  sample_num: 1
#llm_model: text-davinci-003
llm_model: glm-4
embedding_model: embedding-2
llm_temperature: 0.2
llm_temperature_test: 0
max_tokens: 2000
max_tokens_chat: 3000
sample_num: 200
api_batch: 20
chat_api_batch: 10
match_rule: fuzzy
saved: True
loaded: ~
evaluation: basic  # Three modes in evaluation: basic, retrieval, sequential
all_update_rounds: 2
update_neg_item: ~
test_only: ~
item_representation: direct

# TODO: prompt in backward part
user_prompt_system_role: "You are a CD enthusiast.\n Here is your previous self-introduction, exhibiting your past preferences and dislikes:\n '$user_description'."
user_prompt_template: "Recently, you considered to choose one CD from two candidates. The features of these two candidate CDs are listed as follows:\n $list_of_item_description.\n\n After comparing these two candidates based on your preferences and dislikes, you selected '$neg_item_title' to listen to while rejected the other one. You provided the following explanations for your choice, revealing your previous judgment about your preferences and dislikes for these two CDs:\n '$system_reason'. \n\n However, upon actually listening to these two CDs, you discovered that you don't like the CD that you initially chose ('$neg_item_title'). Instead, you prefer the CD that you did not choose before ('$pos_item_title').\n This indicates that you made an incorrect choice, and your judgment about your preferences and dislikes, as recorded in your explanation, was mistaken. It's possible that your preferences and dislikes, described in your previous self-introduction, have either changed or were uninformative. \n Therefore, your task now is to update your self-introduction, by incorporating your new preferences and dislikes revealed in this interaction. \n To do this, please follow these steps: \n 1. Analyze the misconceptions in your previous judgment about your preferences and dislikes, as recorded in your explanation, and correct these mistakes.\n 2. Explore your new preferences based on the features of CDs you really enjoy ('$pos_item_title'), and determine your dislikes based on the features of CDs you truly don't enjoy ('$neg_item_title'). \n 3. Summarize your past preferences and dislikes from your previous self-introduction. Combine your newfound preferences and dislikes with your past preferences and dislikes. Filter and Remove any conflicting or repetitive parts in your past descriptions that contradict your current preferences and dislikes.\n 4. Update your self-introduction. Please start by describing your newfound preferences reflected in this interaction. Then describe your past preferences summarized and filtered from your previous self-introduction. Afterward, please describe your dislikes. \n\n Important note:\n  1. Your output should use the following format: 'My updated self-introduction: [Please write your updated self-introduction here].' \n 2. Keep your updated self-introduction under 180 words.  \n 3. Any overall assessments or summarization in your self-introduction are forbidden.\n 4. You updated self-introduction only need to describe the features of CDs you prefer or dislike, without mentioning your wrong choice or your thinking process in updating your self-introduction. \n 5. You self-introduction should be specific and personalized. Any preferences and dislikes that cannot distinguish you from others are not worth recording."
user_prompt_template_true: "Recently, you considered to choose one CD from two candidates. The features of these two candidate CDs are listed as follows:\n $list_of_item_description.\n\n After comparing these two candidates based on your preferences and dislikes, you selected '$pos_item_title' to listen to while rejected the other one.  You provided the following explanations for your choice, revealing your previous judgment about your preferences and dislikes for these two CDs:\n '$system_reason'. \n\n Congratulations, after actually listening to these two CDs, you find that you very like the CD that your initially chose ('$pos_item_title'). And you indeed dislike the CD that you did not choose before ('$neg_item_title').\n This indicates that you made a correct choice, and your judgment about your preferences and dislikes, as recorded in your explanation, was correct.\n Therefore, your task now is to update your self-introduction, by incorporating your judgment about your preferences and dislikes in this interaction. \n To do this, please follow these steps: \n 1. Analyze your judgment about your preferences and dislikes. which are recorded in your explanation.\n 2. Explore your new preferences based on the features of CDs you like ('$pos_item_title'), and determine your dislikes based on the features of CDs you really don't enjoy ('$neg_item_title'). \n 3. Summarize your past preferences and dislikes from your previous self-introduction. Combine your newfound preferences and dislikes with your past preferences and dislikes. Filter and Remove any conflicting or repetitive parts in your past descriptions that contradict your current preferences and dislikes.\n 4. Update your self-introduction. Please start by describing your newfound preferences reflected in this interaction. Then describe your past preferences summarized and filtered from your previous self-introduction. Afterward, please describe your dislikes. \n\n Important note:\n  1. Your output should use the following format: 'My updated self-introduction: [Please write your updated self-introduction here].' \n 2. Keep your updated self-introduction under 180 words.  \n 3. Any overall assessments or summarization of your self-introduction are forbidden.\n 4. You updated self-introduction only need to describe the features of CDs you prefer or dislike, without mentioning your thinking process in updating your self-introduction. \n 5. You self-introduction should be specific and personalized. Any preferences and dislikes that cannot distinguish you from others are not worth recording."
item_prompt_template: "Here is the self-introduction of a user, exhibiting his preferences and dislikes: '$user_description'.\n Recently, the user browsed a shopping website and considered to choose one CD from two candidate CDs.\n The descriptions of the two candidate CDs are as follows:\n $list_of_item_description.\n\n By considering his preferences and dislikes from his self-introduction, he chose '$neg_item_title' to listen to while rejected the other one. He provided the following explanations for his choices: '$system_reason'. \n\n However, the user found that he actually doesn't enjoy the CD that he previously chosen. Conversely, he finds the CD that he didn't choose before, titled '$pos_item_title', more appealing. This indicates that he made an unsuitable choice. This may be because the user was misled by the descriptions of these two candidate CDs. Actually, the user prefers a CD ('$pos_item_title') because its features aligns with his preferences and go against his dislikes, while he dislikes the other CD ('$neg_item_title') because it possesses features that he disliked. Therefore, your task is to update the descriptions of these two candidate CDs. \n To do this, follow these steps:\n 1. Analyze which features recorded in the previous CD description led to the unsuitable choice based on the user's explanation, and modify them accordingly. \n 2. Analyze the user's preferences and dislikes from his self-introduction. Explore the user preferred CD's new features that aligns with the user's preferences and goes against with his dislikes. Explore the user disliked CD's new features that aligns with the user's dislikes and goes against with his preferences. In this case, the differences between the descriptions of these two items should be amplified. Your exploration should be thorough and detailed, rather than just superficial. For example, you can't simply say a CD's genre aligns with or goes against the user's preferences, as that is too broad.\n 3. Incorporate the item's newfound features with the into its previous description. Since the previous descriptions of the candidate CDs are based on evaluations from other users, it is also worth preserving valuable content. Please try to maintain conciseness while preserving the information as much as possible.\n\n Important notes: \n 1. Your output should in the following format: 'The updated description of the first CD is: [updated description]. \\n The updated description of the second CD is: [updated description].'. \n 2. Each updated CD description can not exceed 50 words!!! \n 3. In your updated CD description, considering that it will be visible to other users, it is advisable to utilize user preferences or dislikes when referring to a group of users collectively, rather than using 'the user' to specifically denote an individual. For instance, you can mention 'the user with ... preferences/dislikes'.\n  4. The updated CD description should not contradict the inherent characteristics of this CD. For example, you can not say that a hip-hop CD has a very soothing rhythm. \n 5. The updated CD description should be specific, containing only the distinguishing features that differentiate this CD from others. "
item_prompt_template_true: "Here is the self-description of a user, exhibiting his preferences and dislikes: '$user_description'.\n Recently, the user browsed a shopping website and considered to choose one CD from two candidate CDs. \n The descriptions of the two candidate CDs are as follows:\n $list_of_item_description.\n\n By comparing these two candidate CDs, the user finally chose to listen to '$pos_item_title'.\n  Actually, the user chose a CD ('$pos_item_title') because its features aligns with his personal preferences, while he rejected the other CD ('$neg_item_title') because it possesses features that he disliked. Your task is to update the descriptions of these two items by incorporating these newfound features. To do this, follow these steps:\n 1. Analyze the user's preferences and dislikes from his self-description. \n 2. Explore the chosen CD's new features that aligns with the user's preferences and goes against with his dislikes. Explore the rejected CD's new features that aligns with the user's dislikes and goes against with his preferences. In this case, the differences between the descriptions of these two items should be amplified. Your exploration should be thorough and detailed, rather than just superficial. For example, you can't simply say a CD's genre aligns with or goes against the user's preferences, as that is too broad. \n 3. Incorporate the item's newfound features with the into its previous description. Please try to maintain conciseness while preserving the information as much as possible.\n\n Important notes: \n 1. Your output should in the following format: 'The updated description of the first CD is: [updated description]. \\n The updated description of the second CD is: [updated description].'. \n 2. Each updated CD description can not exceed 50 words! \n 3. In your updated CD description, considering that it will be visible to other users, it is advisable to utilize user preferences or dislikes when referring to a group of users collectively, rather than using 'the user' to specifically denote an individual. For instance, you can mention 'the user with ... preferences/dislikes'.\n  4. Although the newfound CD features are derived from the real preferences or dislikes of users, the updated CD description should not contradict the inherent characteristics of this CD. For example, you can not say that a hip-hop CD has a very soothing rhythm."



# TODO: prompt in forward part
system_prompt_template: "You are a CD enthusiast. Here is your self-introduction, expressing your preferences and dislikes: '$user_description'. \n\n Now, you are considering to select a CD from two candidate CDs. The features of these two candidate CDs are listed as follows: \n $list_of_item_description.\n\n  Please select the CD that aligns best with your preferences. Furthermore, you must articulate why you've chosen that particular CD while rejecting the other. \n To do this, please follow these steps:\n 1. Extract your preferences and dislikes from your self-introduction. \n  2. Evaluate the two candidate CDs in light of your preferences and dislikes. Make your choice by considering the correlation between your preferences/dislikes and the features of the CDs.\n 3. Explain why you make such choices, from the perspective of the relationship between your preferences/dislikes and the features of these candidate CDs. \n\n Important note:\n 1. **Output Format: Your response must adhere strictly to the following format:** 'Choice: [Title of the selected CD] \\n Explanation: [Detailed rationale behind your choice and reasons for rejecting the other CD]'. \n 2. When identifying your likes and dislikes, don't fabricate them! If your self-introduction doesn't specify any relevant preferences or dislikes, use common knowledge to inform your decision, such as the popularity of the CDs. \n 3. you must choose one of these two candidates, instead of choosing both of them. \n 4. Your explanation needs to be comprehensive and specific. A general preference, such as a certain genre of CD, is insufficient. Your reasoning should delve into the finer attributes of the CD.\n 5. Base your explanation on facts. For instance, if your self-introduction doesn’t reveal any specific preferences, you cannot assert that your decision was influenced by such preferences."


system_prompt_template_backward: "You are a CD recommender system. In the past, you recommended a CD out of two candidates to a user based on the specific recommendation strategy. Then the user generated feedbacks to your recommendation. Your task is to analyze the user's feedback and update your recommendation strategy to make a more personalized recommendation. \n\n Specifically, the user wrote the following description of himself, including his recent preferences and aversiosn: '$user_description'.\n There are two candidate CDs. The first CD is described as follows: '$item_description_1' \n The second CD is described as follows: '$item_description_2'. \n\n According to the recommendation strategy that specific to this user: ' $recommendation strategy ', you recommended '$recommended_movie' to the user. \n However, the user ultimately selected $pos_movie to listen, and provided reasons for his descision: '$user_reasons'. The user's choice in this interactions confirms your recommendation strategy and the recommended CD are $truth_or_falsity . You task is to update the recommendation strategy to make it more personalized. To do this, follow these steps: \n 1. Analyze why you have made $truth_or_falsity recommendations in the past.\n 2. Analyze the factors that the user consider when making his final decision in the process of choosing a CD. \n\n Important note: \n 1. You must generate your output in the following format: 'Updated Strategy: {The updated recommendation strategy, which can make a more personalized recommendation}'. \n 2. The original recommendation strategy may have both suitable and unsuitalbe contents. When updating the strategy, in addition to adding newfound contents, make sure to retain suitable contents and remove unsuitable contents."


# TODO: evaluation prompt: basic
system_prompt_template_evaluation_basic: "I am a CD enthusiast. Here is my self-introduction, which includes my preferences and dislikes:\n\n '$user_description'. \n\n Now, I am looking to find CDs that matches my preferences from a selection of $candidate_num candidates. The features of these candidate CDs are listed as follows:\n $example_list_of_item_description. \n\n Please rearrange these candidate CDs based on my preferences and dislikes by following these steps:\n 1. Analyze my preferences and dislikes from my self-introduction. \n 2. Compare these candidate CDs according to my preferences and dislikes, and then make a recommendation. \n  3. **Output Format: Your ranking result should adhere strictly to the following format.**: 'Rank: {1. CD title \\n 2. CD title ...}.' \n Note: The ranking should be listed with each CD title on a new line. "


# TODO: evaluation prompt: sequential
system_prompt_template_evaluation_sequential: "I am a CD enthusiast. Here is my self-introduction, exhibiting my preferences and dislikes: '$user_description'. In addition, following is my purchasing history of CD: \n $historical_interactions.\n\n Now, I want to find CDs that matches my preferences from a selection of $candidate_num candidate CDs. The features of these candidate CDs are listed as follows:\n $example_list_of_item_description. \n\n Please rearrange these candidate CDs based on my preferences and dislikes.  To do this, please follow these steps:\n 1. Analyze my preferences and dislikes from my self-introduction. \n 2. Compare these candidate CDs according to my preferences and dislikes, and then make recommendation.  You can also consider the candidate CDs' relationships to my previous purchasing history of CDs. \n  3. Please output your recommendation result in the following format: 'Rank: {1. CD title \\n 2. CD title ...}.' \n Note that the rank list should be split by line breakers. "

# TODO: evaluation prompt: retrieval
system_prompt_template_evaluation_retrieval: "I am a CD enthusiast. Here is my previous self-introduction, exhibiting my past preferences and dislikes: '$user_past_description'.\n\n Recently, after listening to some CDs, I found my new preferences and dislikes, thereby updating my self-introduction as follows: '$user_description'. \n\n  Now, I want to find some CDs that matches my preferences from a selection of $candidate_num candidate CDs. The features of these candidate CDs are listed as follows:\n $example_list_of_item_description. \n\n Please rearrange these candidate CDs based on my preferences and dislikes.  To do this, please follow these steps:\n 1. Analyze my past preferences and dislikes from my previous self-introduction. \n 2. Analyze my current preferences and dislikes from my updated self-introduction. \n 3. Compare these candidate CDs and analyze their relationships to my preferences and dislikes. Rearrange these candidates based on your analysis. \n 4. Generate your output in the following format: 'Rank: {1. CD title \\n 2. CD title ...}.' \n Note that the rank list should be split by line breakers. \n\n Important note:\n When recommending CDs, you should primarily consider my current preferences and dislikes. However, my past preferences and dislikes are also valuable information. When you are unable to determine what CD to recommend based on my current preferences and dislikes, do not forget to refer to my past preferences and dislikes."


api_key_list: ['3bff6e47e2ef49b48cec36b3022332b5.zQTK7o7lr7jtpsrX']
current_key_idx: 0
